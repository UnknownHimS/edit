<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HD Media Editor - Instagram & Facebook</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #a0a0a0;
            margin-bottom: 30px;
        }

        .layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel h3 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            font-size: 1.1rem;
            padding: 15px;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(56, 239, 125, 0.4);
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-secondary {
            background: #34495e;
            color: white;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.9rem;
        }

        input[type="color"] {
            height: 45px;
            cursor: pointer;
        }

        input[type="range"] {
            cursor: pointer;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: #a0a0a0;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .canvas-container {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            border-radius: 15px;
            padding: 20px;
            min-height: 600px;
        }

        canvas {
            max-width: 100%;
            max-height: 70vh;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            cursor: move;
        }

        .text-list {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .text-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .text-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .text-item.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
        }

        .video-controls {
            margin-top: 20px;
        }

        video {
            width: 100%;
            border-radius: 10px;
            margin-top: 10px;
        }

        .color-input-group {
            display: flex;
            gap: 10px;
        }

        .color-input-group input[type="text"] {
            width: 100px;
        }

        .style-buttons {
            display: flex;
            gap: 10px;
        }

        .style-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s;
        }

        .style-buttons button.active {
            background: #667eea;
        }

        .info-text {
            font-size: 0.85rem;
            color: #888;
            margin-top: 10px;
        }

        @media (max-width: 1024px) {
            .layout {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® HD Media Editor</h1>
        <p class="subtitle">Create stunning HD content for Instagram & Facebook</p>

        <div class="layout">
            <!-- Left Panel - Controls -->
            <div>
                <!-- Upload Section -->
                <div class="panel control-group">
                    <h3>üì§ Upload Media</h3>
                    <input type="file" id="fileInput" accept="image/*,video/*" style="display: none;">
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        Choose Image/Video
                    </button>
                </div>

                <!-- Aspect Ratio -->
                <div class="panel control-group">
                    <h3>üìê Format</h3>
                    <select id="aspectRatio">
                        <option value="1:1">Instagram Square (1080x1080)</option>
                        <option value="4:5">Instagram Portrait (1080x1350)</option>
                        <option value="9:16">Instagram Story/Reels (1080x1920)</option>
                        <option value="16:9">Facebook Landscape (1920x1080)</option>
                    </select>
                </div>

                <!-- Background Color -->
                <div class="panel control-group">
                    <h3>üé® Background</h3>
                    <div class="color-input-group">
                        <input type="color" id="bgColor" value="#1a1a2e">
                        <input type="text" id="bgColorText" value="#1a1a2e">
                    </div>
                </div>

                <!-- Transform Controls -->
                <div class="panel control-group" id="transformPanel" style="display: none;">
                    <h3>üîÑ Transform</h3>
                    <label>Zoom: <span id="zoomValue">1.0</span>x</label>
                    <input type="range" id="zoom" min="0.1" max="3" step="0.1" value="1">
                    
                    <label style="margin-top: 15px;">Rotation: <span id="rotationValue">0</span>¬∞</label>
                    <input type="range" id="rotation" min="0" max="360" step="15" value="0">
                </div>

                <!-- Text Controls -->
                <div class="panel control-group">
                    <h3>‚úèÔ∏è Text</h3>
                    <button class="btn btn-secondary" onclick="addText()">+ Add Text</button>
                    
                    <div class="text-list" id="textList"></div>

                    <div id="textEditor" style="display: none; margin-top: 15px;">
                        <label>Text Content</label>
                        <textarea id="textContent" rows="2"></textarea>
                        
                        <div class="grid-2" style="margin-top: 10px;">
                            <div>
                                <label>Font Size</label>
                                <input type="number" id="fontSize" value="48" min="12" max="200">
                            </div>
                            <div>
                                <label>Color</label>
                                <input type="color" id="textColor" value="#ffffff">
                            </div>
                        </div>

                        <label style="margin-top: 10px;">Font Family</label>
                        <select id="fontFamily">
                            <option value="Arial">Arial</option>
                            <option value="Helvetica">Helvetica</option>
                            <option value="'Times New Roman'">Times New Roman</option>
                            <option value="Georgia">Georgia</option>
                            <option value="'Courier New'">Courier New</option>
                            <option value="Impact">Impact</option>
                            <option value="Verdana">Verdana</option>
                        </select>

                        <div class="style-buttons" style="margin-top: 10px;">
                            <button id="boldBtn" onclick="toggleBold()">Bold</button>
                            <button id="italicBtn" onclick="toggleItalic()">Italic</button>
                        </div>

                        <button class="btn btn-danger" onclick="deleteSelectedText()" style="margin-top: 15px;">
                            üóëÔ∏è Delete Text
                        </button>
                    </div>
                </div>

                <!-- Audio Controls -->
                <div class="panel control-group">
                    <h3>üéµ Background Music/Sound</h3>
                    <input type="file" id="audioInput" accept="audio/*" style="display: none;">
                    <button class="btn btn-secondary" onclick="document.getElementById('audioInput').click()">
                        Upload Audio
                    </button>
                    
                    <div id="audioControls" style="display: none; margin-top: 15px;">
                        <audio id="audioElement" controls style="width: 100%; border-radius: 8px;"></audio>
                        <label style="margin-top: 10px;">Volume: <span id="volumeValue">100</span>%</label>
                        <input type="range" id="volume" min="0" max="100" value="100">
                        <button class="btn btn-danger" onclick="removeAudio()" style="margin-top: 10px;">
                            üóëÔ∏è Remove Audio
                        </button>
                    </div>
                </div>

                <!-- Export Button -->
                <button class="btn btn-success" onclick="exportMedia()">
                    ‚¨áÔ∏è Export HD Image
                </button>
            </div>

            <!-- Right Panel - Canvas -->
            <div class="panel">
                <h3>üëÅÔ∏è Preview</h3>
                <div class="canvas-container">
                    <canvas id="canvas"></canvas>
                </div>
                <div id="videoControlsDiv" style="display: none;">
                    <video id="videoElement" controls></video>
                    <p class="info-text">Use video controls to select frame. Export captures current frame as HD image.</p>
                </div>
            </div>
        </div>
    </div>

<script>
let state = {
    media: null,
    mediaType: null,
    mediaLoaded: false,
    textElements: [],
    selectedTextId: null,
    zoom: 1,
    rotation: 0,
    position: { x: 0, y: 0 },
    dragOffset: { x: 0, y: 0 },
    isDragging: false,
    audio: null
};

const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

const aspectRatios = {
    '1:1': { width: 1080, height: 1080 },
    '4:5': { width: 1080, height: 1350 },
    '9:16': { width: 1080, height: 1920 },
    '16:9': { width: 1920, height: 1080 }
};

// Initialize
document.getElementById('fileInput').addEventListener('change', handleFileUpload);
document.getElementById('audioInput').addEventListener('change', handleAudioUpload);
document.getElementById('aspectRatio').addEventListener('change', drawCanvas);
document.getElementById('bgColor').addEventListener('input', e => {
    document.getElementById('bgColorText').value = e.target.value;
    drawCanvas();
});
document.getElementById('bgColorText').addEventListener('input', e => {
    if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
        document.getElementById('bgColor').value = e.target.value;
        drawCanvas();
    }
});

document.getElementById('zoom').addEventListener('input', e => {
    state.zoom = parseFloat(e.target.value);
    document.getElementById('zoomValue').textContent = state.zoom.toFixed(1);
    drawCanvas();
});

document.getElementById('rotation').addEventListener('input', e => {
    state.rotation = parseInt(e.target.value);
    document.getElementById('rotationValue').textContent = state.rotation;
    drawCanvas();
});

document.getElementById('textContent').addEventListener('input', e => {
    const text = state.textElements.find(t => t.id === state.selectedTextId);
    if (text) {
        text.content = e.target.value;
        drawCanvas();
        updateTextList();
    }
});

document.getElementById('fontSize').addEventListener('input', e => {
    const text = state.textElements.find(t => t.id === state.selectedTextId);
    if (text) {
        text.fontSize = parseInt(e.target.value);
        drawCanvas();
    }
});

document.getElementById('textColor').addEventListener('input', e => {
    const text = state.textElements.find(t => t.id === state.selectedTextId);
    if (text) {
        text.color = e.target.value;
        drawCanvas();
    }
});

document.getElementById('fontFamily').addEventListener('change', e => {
    const text = state.textElements.find(t => t.id === state.selectedTextId);
    if (text) {
        text.fontFamily = e.target.value;
        drawCanvas();
    }
});

document.getElementById('volume').addEventListener('input', e => {
    const audio = document.getElementById('audioElement');
    audio.volume = e.target.value / 100;
    document.getElementById('volumeValue').textContent = e.target.value;
});

// Load Media
function handleFileUpload(e) {
    const file = e.target.files[0];
    if (!file) return;

    const url = URL.createObjectURL(file);
    state.mediaType = file.type.startsWith('video') ? 'video' : 'image';
    state.mediaLoaded = false;

    if (state.mediaType === 'image') {
        const img = new Image();
        img.onload = () => {
            state.media = img;
            state.mediaLoaded = true;
            document.getElementById('transformPanel').style.display = 'block';
            document.getElementById('videoControlsDiv').style.display = 'none';
            drawCanvas();
        };
        img.src = url;
    } else {
        const video = document.getElementById('videoElement');
        video.src = url;
        video.onloadeddata = () => {
            state.media = video;
            state.mediaLoaded = true;
            document.getElementById('transformPanel').style.display = 'block';
            document.getElementById('videoControlsDiv').style.display = 'block';
            drawCanvas();
        };
        video.addEventListener('timeupdate', drawCanvas);
    }
}

// Audio Upload
function handleAudioUpload(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    const url = URL.createObjectURL(file);
    const audio = document.getElementById('audioElement');
    audio.src = url;
    state.audio = file;
    document.getElementById('audioControls').style.display = 'block';
}

function removeAudio() {
    const audio = document.getElementById('audioElement');
    audio.src = '';
    state.audio = null;
    document.getElementById('audioControls').style.display = 'none';
}

// Draw Canvas
function drawCanvas() {
    const { width, height } = aspectRatios[document.getElementById('aspectRatio').value];
    canvas.width = width;
    canvas.height = height;

    // Background
    ctx.fillStyle = document.getElementById('bgColor').value;
    ctx.fillRect(0, 0, width, height);

    // Draw media
    if (state.media && state.mediaLoaded) {
        ctx.save();
        ctx.translate(width / 2, height / 2);
        ctx.rotate(state.rotation * Math.PI / 180);
        ctx.scale(state.zoom, state.zoom);

        const mw = state.media.videoWidth || state.media.width;
        const mh = state.media.videoHeight || state.media.height;
        const scale = Math.max(width / mw, height / mh);
        const sw = mw * scale;
        const sh = mh * scale;

        ctx.drawImage(state.media, -sw / 2 + state.position.x, -sh / 2 + state.position.y, sw, sh);
        ctx.restore();
    }

    drawTexts();
}

// Draw Texts
function drawTexts() {
    state.textElements.forEach(text => {
        ctx.font = `${text.italic ? 'italic' : ''} ${text.bold ? 'bold' : ''} ${text.fontSize}px ${text.fontFamily}`;
        ctx.fillStyle = text.color;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.fillText(text.content, text.x, text.y);

        if (state.selectedTextId === text.id) {
            const width = ctx.measureText(text.content).width;
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.strokeRect(text.x - 4, text.y - 4, width + 8, text.fontSize + 8);
        }
    });
}

// Text Management
function addText() {
    const text = {
        id: Date.now(),
        content: 'New Text',
        x: 100,
        y: 100,
        fontSize: 48,
        color: '#ffffff',
        fontFamily: 'Arial',
        bold: false,
        italic: false
    };
    state.textElements.push(text);
    selectText(text.id);
}

function selectText(id) {
    state.selectedTextId = id;
    const text = state.textElements.find(t => t.id === id);
    
    if (text) {
        document.getElementById('textEditor').style.display = 'block';
        document.getElementById('textContent').value = text.content;
        document.getElementById('fontSize').value = text.fontSize;
        document.getElementById('textColor').value = text.color;
        document.getElementById('fontFamily').value = text.fontFamily;
        document.getElementById('boldBtn').classList.toggle('active', text.bold);
        document.getElementById('italicBtn').classList.toggle('active', text.italic);
    }
    
    updateTextList();
    drawCanvas();
}

function updateTextList() {
    const list = document.getElementById('textList');
    list.innerHTML = state.textElements.map(text => 
        `<div class="text-item ${state.selectedTextId === text.id ? 'selected' : ''}" 
              onclick="selectText(${text.id})">
            ${text.content.substring(0, 30)}${text.content.length > 30 ? '...' : ''}
        </div>`
    ).join('');
}

function toggleBold() {
    const text = state.textElements.find(t => t.id === state.selectedTextId);
    if (text) {
        text.bold = !text.bold;
        document.getElementById('boldBtn').classList.toggle('active', text.bold);
        drawCanvas();
    }
}

function toggleItalic() {
    const text = state.textElements.find(t => t.id === state.selectedTextId);
    if (text) {
        text.italic = !text.italic;
        document.getElementById('italicBtn').classList.toggle('active', text.italic);
        drawCanvas();
    }
}

function deleteSelectedText() {
    state.textElements = state.textElements.filter(t => t.id !== state.selectedTextId);
    state.selectedTextId = null;
    document.getElementById('textEditor').style.display = 'none';
    updateTextList();
    drawCanvas();
}

// Canvas Interactions
canvas.addEventListener('mousedown', e => {
    const rect = canvas.getBoundingClientRect();
    const x = (e.clientX - rect.left) * (canvas.width / rect.width);
    const y = (e.clientY - rect.top) * (canvas.height / rect.height);

    for (let i = state.textElements.length - 1; i >= 0; i--) {
        const text = state.textElements[i];
        ctx.font = `${text.fontSize}px ${text.fontFamily}`;
        const w = ctx.measureText(text.content).width;
        const h = text.fontSize;

        if (x >= text.x && x <= text.x + w && y >= text.y && y <= text.y + h) {
            selectText(text.id);
            state.dragOffset = { x: x - text.x, y: y - text.y };
            state.isDragging = true;
            return;
        }
    }

    state.selectedTextId = null;
    document.getElementById('textEditor').style.display = 'none';
    updateTextList();
    drawCanvas();
});

canvas.addEventListener('mousemove', e => {
    if (!state.isDragging) return;
    const rect = canvas.getBoundingClientRect();
    const x = (e.clientX - rect.left) * (canvas.width / rect.width);
    const y = (e.clientY - rect.top) * (canvas.height / rect.height);

    const text = state.textElements.find(t => t.id === state.selectedTextId);
    if (text) {
        text.x = x - state.dragOffset.x;
        text.y = y - state.dragOffset.y;
        drawCanvas();
    }
});

canvas.addEventListener('mouseup', () => {
    state.isDragging = false;
});

// Export
function exportMedia() {
    canvas.toBlob(blob => {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        const format = document.getElementById('aspectRatio').value.replace(':', 'x');
        a.download = `media-${format}-${Date.now()}.png`;
        a.click();
    }, 'image/png', 1.0);
}

// Initialize canvas
drawCanvas();
    </script>
</body>
</html>
